\chapter{数値実験}
\label{chap:数値実験}
本章では前章で考察した固定小数点による数値計算を具体的な初期値問題を対象に適用し，浮動小数点を用いた計算結果との誤差を比較する．
%キャプションは本文を見なくても図や表を見た時に理解できるように書く
\section{実験の設定，目的}
対象とした問題は，？つある．
実験に用いる数値解法は，陽的Euler法，4段4次陽的Runge-Kutta法である．
また，数値実験の比較する対象としては，数値解法としての計算の精度と，厳密解と比較しての計算の精度の２種類の比較を行った．
ともに，誤差ノルムを用いて比較を行った．
数値解法としての計算の精度は，同じ解法を用いた時のその計算結果に対する比較である．
数値解法を用いて対象の方程式を解く場合，対象の方程式を近似し，その近似によって厳密解と数値解の間には誤差が生じる．
しかし，数値解法としての計算の精度は，その近似によって生じる誤差を考えず，数値計算として得られたもの同士を比較する．
厳密には数値解法としての正確な計算結果を得ることも困難であるため，BigFloat型を用いて行った計算結果を正確な計算結果とみなし，その計算結果と各数値型での計算結果を比較した．
つまり，同じ数値解法を用いてBigFloat型で計算を行った場合の計算結果を$\bar{\bm{x}} \in \R^n$として，各数値型で行った計算結果を$\hat{\bm{x}} \in \R^n$とすると，その誤差ノルム$\bar{e}$は，
\begin{equation}
    \bar{e} = \|\bar{\bm{x}} - \hat{\bm{x}}\| = \sqrt{(\bar{x}_1 - \hat{x}_1)^2 + (\bar{x}_2 - \hat{x}_2)^2 + \cdots (\bar{x}_n - \hat{x}_n)^2}
\end{equation}
と定義する．
また，厳密解との比較についても対象とした問題の厳密解を得ることは非常に困難であるため，十分に精度の高い数値解法(DifferintialEquations.jlのパッケージを用いて行った数値計算)を厳密解の代わりとし，その計算結果と各数値型での計算結果を比較した．
つまり，厳密解相当の値を$\bm{x}^{\ast} \in \R^n$，ある数値解法で各数値型を用いて行った計算結果を$\hat{\bm{x}} \in \R^n$とすると，その誤差ノルム$e^{\ast}$は，
\begin{equation}
   e^{\ast} = \|\bm{x}^{\ast} - \hat{\bm{x}}\| = \sqrt{(x_1^{\ast} - \hat{x}_1)^2 + (x_2^{\ast} - \hat{x}_2)^2 + \cdots (x_n^{\ast} - \hat{x}_n)^2}
\end{equation}
と定義する．
また，方程式のパラメータや初期値については，数値計算を行う上で誤差ができる他で生じないように2進数を用いて有限の桁数で表すことのできる数を用いた．
使用した数値型については，浮動小数点はすべての方程式においてBigFloat型とFloat64型を用いた．
固定小数点は，すべての方程式において小数部が52bitのQ11f52型とそれぞれの方程式において計算結果がオーバーフローやアンダーフローを起こさない範囲で小数部に最大限のbit数を割り当てることのできる型を用いた．
Q11f52型は，Float64型の仮数部と同じbit数を小数部に割り当てた固定小数点型である．
\section{数値実験の例}
\subsection{Lorenz方程式}
Lorenz方程式は，次のような式で与えられる微分方程式である：
\begin{align}
    \frac{dx}{dt} &= \sigma(y-x), \\
    \frac{dy}{dt} &= x(\rho-z)-y, \\
    \frac{dz}{dt} &= xy - \beta z.
\end{align}
ただし，$\sigma,\rho,\beta$はパラメータである．
図(\ref{fig:lorenz})はLorenz方程式の解の時間発展の様子の一例である．
\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\linewidth]{fig_lorenz/lorenz_2^(-7)_BigFloat_exact.pdf}
    \caption{Lorenz方程式の時間発展の様子（$\sigma=10$, $\rho=28$, $\beta=2.6640625$）}
    \label{fig:lorenz}
\end{figure}
%Lorenz方程式の時間発展の様子を図示
実験では，$\sigma=10$, $\rho=28$, $\beta=2.6640625$，初期値は$x(0) = 0.5, y(0) = 0.5, z(0) = 0.5$とした．
計算時間の領域は$t \in [0,2^7]$，数値解法では刻み幅を$\Delta t =  2^{-7}, 2^{-13}$とした．
パラメータの値は，
\begin{align}
    \sigma &= 10 = 2^3 + 2^1, \\
    \rho &= 28 = 2^4 + 2^3 + 2^2, \\
    \beta &= 2.6640625 = 2^1 + 2^{-1} + 2^{-3} + 2^{-5} + 2^{-7}
\end{align}
であり，初期値の値は，
\begin{align}
    x(0) &= 0.5 = 2^{-1}, \\
    y(0) &= 0.5 = 2^{-1}, \\
    z(0) &= 0.5 = 2^{-1}
\end{align}
である．
\paragraph*{陽的Euler法を用いた場合}
最初に，Euler法による計算の数値解に対する誤差を確かめる．
数値解法のきざみ幅を$\Delta t = 2^{-7},2^{-13}$とした場合のEuler法による数値解の誤差を比較した．
以下がその結果である．
\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lorenz/lorenz_2^(-7)_euler_error.pdf}
        \caption{Euler法を用いて更新幅を$\Delta t = 2^{-7}$とした場合の異なる数値型(Float64,Q11f52,Q9f54)を用いて数値計算をしたときの数値解とBigFloat型を用いた精度の高い数値解との誤差}
        \label{fig:lorenz_2^(-7)_euler_error}
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lorenz/lorenz_2^(-13)_euler_error.pdf}
        \caption{Euler法を用いて更新幅を$\Delta t =  2^{-13}$とした場合の異なる数値型(Float64,Q11f52,Q9f54)を用いて数値計算をしたときの数値解とBigFloat型を用いた精度の高い数値解との誤差}
        \label{fig:lorenz_2^(-13)_euler_error}
    \end{minipage}
\end{figure}
%考察
次に，厳密解と各数値型でのEuler法による計算結果の比較を行った．
以下がその結果である．
\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lorenz/lorenz_2^(-7)_euler_exact_error.pdf}
        \caption{Euler法を用いて更新幅を$\Delta t = 2^{-7}$とした場合の異なる数値型(Float64,Q11f52,Q9f54)を用いて数値計算をしたときの数値解と厳密解相当の誤差}
        \label{fig:lorenz_2^(-7)_euler_exact_error}
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lorenz/lorenz_2^(-13)_euler_exact_error.pdf}
        \caption{Euler法を用いて更新幅を$\Delta t =  2^{-13}$とした場合の異なる数値型(Float64,Q11f52,Q9f54)を用いて数値計算をしたときの数値解と厳密解相当の数値解との誤差}
        \label{fig:lorenz_2^(-13)_euler_exact_error}
    \end{minipage}
\end{figure}

\paragraph*{4段4次陽的Runge-Kutta法を用いた場合}
最初に，4段4次陽的Runge-Kutta法による計算の数値解に対する誤差を確かめる．
数値解法の刻み幅を$\Delta t = 2^{-7},2^{-13}$とした場合の4段4次陽的Runge-Kutta法による数値解の誤差を比較した．
以下がその結果である．
\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lorenz/lorenz_2^(-7)_rk4_error.pdf}
        \caption{4段4次陽的Runge-Kutta法を用いて更新幅を$\Delta t = 2^{-7}$とした場合の異なる数値型(Float64,Q11f52,Q9f54)を用いて数値計算をしたときの数値解とBigFloat型を用いた精度の高い数値解との誤差}
        \label{fig:lorenz_2^(-7)_rk4_error}
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lorenz/lorenz_2^(-13)_rk4_error.pdf}
        \caption{4段4次陽的Runge-Kutta法を用いて更新幅を$\Delta t =  2^{-13}$とした場合の異なる数値型(Float64,Q11f52,Q9f54)を用いて数値計算をしたときの数値解とBigFloat型をとの誤差}
        \label{fig:lorenz_2^(-13)_rk4_error}
    \end{minipage}
\end{figure}
%考察
次に，4段4次陽的Runge-Kutta法を用いた場合での数値解の誤差を確認した．
以下がその結果である．
\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lorenz/lorenz_2^(-7)_rk4_exaxt_error.pdf}
        \caption{4段4次陽的Runge-Kutta法を用いて更新幅を$\Delta t = 2^{-7}$とした場合の異なる数値型(Float64,Q11f52,Q9f54)を用いて数値計算をしたときの数値解と厳密解相当の数値解との誤差}
        \label{fig:lorenz_2^(-7)_rk4_exact_error}
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lorenz/lorenz_2^(-13)_rk4_exact_error.pdf}
        \caption{4段4次陽的Runge-Kutta法を用いて更新幅を$\Delta t =  2^{-13}$とした場合の異なる数値型(Float64,Q11f52,Q9f54)を用いて数値計算をしたときの数値解と厳密解相当の数値解との誤差}
        \label{fig:lorenz_2^(-13)_rk4_exact_error}
    \end{minipage}
\end{figure}
%考察

\subsection{Duffing方程式}
Duffing方程式は，次のような式で与えられる微分方程式である：
\begin{align}
    \frac{d^2 x}{dt^2} + \delta\frac{dx}{dt} - \alpha x + \beta x^3 - \gamma \cos(\omega t) = 0
\end{align}.
ただし，$\delta,\alpha,\beta,\gamma,\omega$はパラメータである．
図(？)はその一例である．
%Duffing方程式の時間発展の様子を図示
対象の問題のパラメータは$\delta=0.1, \alpha=-0.4, \beta=2.0, \gamma=2.0, \omega=2.4$，初期値は$x(0) = 1.0, dx/dt(0) = 1.0$とした．
計算時間の領域は$t \in [0,1.0 \times 10^2]$，数値解法では刻み幅を$\Delta t =  2^{-7}, 2^{-13}$とした．
\paragraph*{陽的Euler法を用いた場合}

\paragraph*{4段4次陽的Runge-Kutta法を用いた場合}

\subsection{Rossler方程式}
Rossler方程式は，次のような式で与えられる微分方程式である：
\begin{align}
    \frac{dx}{dt} &= -y-z, \\
    \frac{dy}{dt} &= x+ay, \\
    \frac{dz}{dt} &= bx + xz - cz.
\end{align}
ただし，$a,b,c$はパラメータである．
図(\ref{fig:rossler})はRossler方程式の解の時間発展の様子の一例である．
%Rossler方程式の時間発展の様子を図示
\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\linewidth]{fig_rossler2/rossler_2^(-13)_BigFloat_rk4.pdf}
    \caption{Rossler方程式の解の時間発展の様子}
    \label{fig:rossler}
\end{figure}
実験では,$a=0.34275, b=0.390625, c=4.5$，初期値は$x(0) = 4.0, y(0) = 4.0, z(0) = 0.0$とした.
計算時間の領域は$t \in [0.0 \times 2^7]$，数値解法では刻み幅を$\Delta t =   2^{-7},2^{-13}$とした．
パラメータの値は，
\begin{align}
    a &= 0.34275 = 2^{-2} + 2^{-4} + 2^{-5},\\
    b &= 0.390625 = 2^{-2} + 2^{-3} + 2^{-5},\\ 
    c &= 4.5 = 2^2 + 2^{-1}
\end{align}
であり，初期値は，
\begin{align}
    x(0) &= 4.0 = 2^2,\\
    y(0) &= 4.0 = 2^2 ,\\
    z(0) &= 0.0 
\end{align}
である．
\paragraph*{陽的Euler法を用いた場合}
最初に，Euler法による計算の数値解に対する誤差を確かめる．
数値解法の刻み幅を$\Delta t = 2^{-7},2^{-13}$とした場合のEuler法による数値解の誤差を比較した．
以下がその結果である．
\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_rossler2/rossler_2^(-7)_euler_error.pdf}
        \caption{Euler法を用いて更新幅を$\Delta t = 2^{-7}$とした場合の異なる数値型(Float64,Q11f52,Q8f55)を用いて数値計算をしたときの数値解とBigFloat型を用いたとの誤差}
        \label{fig:rossler_2^(-7)_euler_error}
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_rossler2/rossler_2^(-13)_euler_error.pdf}
        \caption{Euler法を用いて更新幅を$\Delta t =  2^{-13}$とした場合の異なる数値型(Float64,Q11f52,Q8f55)を用いて数値計算をしたときの数値解とBigFloat型を用いた精度の高い数値解との誤差}
        \label{fig:rossler_2^(-13)_euler_error}
    \end{minipage}
\end{figure} 
Euler法による数値実験では，,$\Delta t = 2^{-7}$とした場合も$\Delta t =  2^{-13}$とした場合も倍精度浮動小数点(Float64)を用いた計算結果と固定小数点(Q11f52)を用いた数値解としての計算精度はほぼ同等と言って良い．


次に，厳密解と各数値型でのEuler法による計算結果の比較を行った．
以下がその結果である．\\
\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_rossler2/rossler_2^(-7)_euler_exact_error.pdf}
        \caption{Euler法を用いて更新幅を$\Delta t = 2^{-7}$とした場合の異なる数値型(Float64,Q11f52,Q8f55)を用いて数値計算をしたときの数値解と厳密解相当の数値解との誤差}
        \label{fig:rossler_2^(-7)_eluer_exact_error}
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_rossler2/rossler_2^(-13)_euler_exact_error.pdf}
        \caption{Eulur法を用いて更新幅を$\Delta t =  2^{-13}$とした場合の異なる数値型(Float64,Q11f52,Q8f55)を用いて数値計算をしたときの数値解と厳密解相当の数値解との誤差}
        \label{fig:rossler_2^(-13)_euler_exact_error}
    \end{minipage}
\end{figure}
Euler法は1次精度の数値解法であるため，厳密解と比較すると精度がかなり悪いため，どの数値型を用いても近似による誤差の影響が大きくなっている．

\paragraph*{4段4次陽的Runge-Kutta法を用いた場合}
最初に，4段4次陽的Runge-Kutta法による計算の数値解の誤差を確かめる．
数値解法の刻み幅を$\Delta t = 2^{-7},2^{-13}$とした場合のRunge-Kutta法による数値解の誤差を比較した．
以下がその結果である．
\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_rossler2/rossler_2^(-7)_rk4_error.pdf}
        \caption{4段4次陽的Runge-Kutta法を用いて更新幅を$\Delta t = 2^{-7}$とした場合の異なる数値型(Float64,Q11f52,Q8f55)を用いて数値計算をしたときの数値解とBigFloat型を用いた精度の高い数値解との誤差}
        \label{fig:rossler_2^(-7)_rk4_error}
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_rossler2/rossler_2^(-13)_rk4_error.pdf}
        \caption{4段4次陽的Runge-Kutta法を用いて更新幅を$\Delta t =  2^{-13}$とした場合の異なる数値型(Float64,Q11f52,Q8f55)を用いて数値計算をしたときの数値解とBigFloat型を用いた精度の高い数値解との誤差}
        \label{fig:rossler_2^(-13)_rk4_error}
    \end{minipage}   
\end{figure}
%考察


次に，厳密解と各数値型でのRunge-Kutta法による計算結果の比較を行った．
以下がその結果である．\\
\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_rossler2/rossler_2^(-7)_rk4_exact_error.pdf}
        \caption{4段4次陽的Runge-Kutta法を用いて更新幅を$\Delta t = 2^{-7}$とした場合の異なる数値型(Float64,Q11f52,Q8f55)を用いて数値計算をしたときの数値解と厳密解相当の数値解との誤差}   
        \label{fig:rossler_2^(-7)_rk4_exact_error}
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_rossler2/rossler_2^(-13)_rk4_exact_error.pdf}
        \caption{4段4次陽的Runge-Kutta法を用いて更新幅を$\Delta t =  2^{-13}$とした場合の異なる数値型(Float64,Q11f52,Q8f55)を用いて数値計算をしたときの数値解と厳密解相当の数値解との誤差}
        \label{fig:rossler_2^(-13)_rk4_exact_error}
    \end{minipage}
\end{figure}
刻み幅$\Delta t = 2^{-7}$では，近似による誤差の影響が大きいと考えられ厳密解と比較して精度が悪い．
一方，刻み幅$\Delta t =  2^{-13}$では，近似による誤差の影響が小さくなりどの数値型を用いても厳密解と比較して精度が良いと言える．

\subsection{Brusselator方程式}
Brusselator方程式は，次のような式で与えられる微分方程式である：
\begin{align}
    \frac{dx}{dt} &= A + x^2y - Bx - x,\\
    \frac{dy}{dt} &= -x^2y + Bx.
\end{align}
ただし，$A,B$はパラメータである．
図(\ref{fig:brusselator})はBrusselator方程式の解の時間発展の様子の一例である．
%Brusselator方程式の時間発展の様子を図示
\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.9\columnwidth}
            \includegraphics[width=0.9\columnwidth]{fig_brusselator2/brusselator_2^(-13)_bigfloat_exact.pdf}
    \end{minipage}
    \caption{Bruesslator方程式の解の時間発展の様子}
    \label{fig:brusselator}
\end{figure}
実験は，$A=1.0, B=3.0$，初期値は$x(0) = 1.0, y(0) = 1.0$とした．
計算時間の領域は$t \in [0.0, \times 2^5]$，数値解法では刻み幅を$\Delta t =  2^{-7}, 2^{-13}$とした．
パラメータの値は，
\begin{align}
    A &= 1.0 = 2^0, \\
    B &= 3.0 = 2^1 + 2^0
\end{align}
であり，初期値は，
\begin{align}
    x(0) &= 1.0 = 2^, \\
    y(0) &= 1.0 = 2^0
\end{align} 
である．
\paragraph*{陽的Euler法を用いた場合}
最初に，Euler法による計算の数値解に対する誤差を確かめる．
数値解法の刻み幅を$\Delta t = 2^{-7},2^{-13}$とした場合のEuler法による数値解の誤差を比較した．
以下がその結果である．
\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_brusselator2/brusselator_2^(-7)_euler_error.pdf}
        \caption{Euler法を用いて更新幅を$\Delta t = 2^{-7}$とした場合の異なる数値型(Float64,Q11f52,Q4f59)を用いて数値計算をしたときの数値解とBigFloat型を用いた精度の高い数値解との誤差}
        \label{fig:brusselator_2^(-7)_euler_error}
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_brusselator2/brusselator_2^(-13)_euler_error.pdf}
        \caption{Euler法を用いて更新幅を$\Delta t =  2^{-13}$とした場合の異なる数値型(Float64,Q11f52,Q4f59)を用いて数値計算をしたときの数値解とBigFloat型を用いた精度の高い数値解との誤差}
        \label{fig:brusselator_2^(-13)_euler_error}
    \end{minipage}
\end{figure}
%考察

次に，厳密解と各数値型でのEuler法による計算結果の比較を行った．
以下がその結果である．\\
\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_brusselator2/brusselator_2^(-7)_euler_exact_error.pdf}
        \caption{Euler法を用いて更新幅を$\Delta t = 2^{-7}$とした場合の異なる数値型(Float64,Q11f52,Q4f59)を用いて数値計算をしたときの数値解と厳密解相当の数値解との誤差}
        \label{fig:brusselator_2^(-7)_euler_exact_error}
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_brusselator2/brusselator_2^(-13)_euler_exact_error.pdf}
        \caption{Euler法を用いて更新幅を$\Delta t =  2^{-13}$とした場合の異なる数値型(Float64,Q11f52,Q4f59)を用いて数値計算をしたときの数値解と厳密解相当の数値解との誤差}
        \label{fig:brusselator_2^(-13)_euler_exact_error}
    \end{minipage}
\end{figure}
%考察



\paragraph*{4段4次陽的Runge-Kutta法を用いた場合}
最初に，4段4次陽的Runge-Kutta法による計算の数値解に対する誤差を確かめる．
数値解法の刻み幅を$\Delta t = 2^{-7},2^{-13}$とした場合の4段4次陽的Runge-Kutta法による数値解の誤差を比較した．
以下がその結果である．
\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_brusselator2/brusselator_2^(-7)_rk4_error.pdf}
        \caption{4段4次陽的Runge-Kutta法を用いて更新幅を$\Delta t = 2^{-7}$とした場合の異なる数値型(Float64,Q11f52,Q4f59)を用いて数値計算をしたときの数値解とBigFloat型を用いた精度の高い数値解との誤差}
        \label{fig:brusselator_2^(-7)_rk4_error}
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_brusselator2/brusselator_2^(-13)_rk4_error.pdf}
        \caption{4段4次陽的Runge-Kutta法を用いて更新幅を$\Delta t =  2^{-13}$とした場合の異なる数値型(Float64,Q11f52,Q4f59)を用いて数値計算をしたときの数値解とBigFloat型を用いた精度の高い数値解との誤差}
        \label{fig:brusselator_2^(-13)_rk4_error}
    \end{minipage}
\end{figure}
%考察

次に，厳密解と各数値型での4段4次陽的Runge-Kutta法による計算結果の比較を行った．
以下がその結果である．\\
\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_brusselator2/brusselator_2^(-7)_euler_exact_error.pdf}
        \caption{4段4次陽的Runge-Kutta法を用いて更新幅を$\Delta t = 2^{-7}$とした場合の異なる数値型(Float64,Q11f52,Q4f59)を用いて数値計算をしたときの数値解と厳密解相当の数値解との誤差}
        \label{fig:brusselator_2^(-7)_rk4_exact_error}
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_brusselator2/brusselator_2^(-13)_rk4_exact_error.pdf}
        \caption{4段4次陽的Runge-Kutta法を用いて更新幅を$\Delta t =  2^{-13}$とした場合の異なる数値型(Float64,Q11f52,Q4f59)を用いて数値計算をしたときの数値解と厳密解相当の数値解との誤差}
        \label{fig:brusselator_2^(-13)_rk4_exact_error}
    \end{minipage}
\end{figure}
%考察

\subsection{Lotka-Volterra方程式}
Brusselator方程式は，次のような式で与えられる微分方程式である：
\begin{align}
    \frac{dx}{dt} &=  ax - bxy,\\
    \frac{dy}{dt} &= cxy - dx.
\end{align}
ただし，$a,b,c,d$はパラメータである．
図(\ref{fig:lotkavolterra})はLotka-Volterra方程式の解の時間発展の様子の一例である．
%Brusselator方程式の時間発展の様子を図示
\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.9\columnwidth}
            \includegraphics[width=0.9\columnwidth]{fig_lotkavolterra/lotkavolterra_2^(-13)_BigFloat_exact.pdf}
    \end{minipage}
    \caption{Lotka-Volterra方程式の解の時間発展の様子}
    \label{fig:lotkavolterra}
\end{figure}
実験は，$a=1.0, b=1.0 c=1.0, d=1.0$，初期値は$x(0) = 0.5, y(0) = 0.25$とした．
計算時間の領域は$t \in [0.0, \times 2^5]$，数値解法では刻み幅を$\Delta t =  2^{-7}, 2^{-13}$とした．


また，Lotka-Volterra方程式は，次のような保存量$H$
\begin{equation}
    H = cx(t) + by(t) -d \log\left(x(t)\right) - a \log\left(y(t)\right)
\end{equation}
を持ち時刻$t$に関わらずその値は一定である．以下では，初期時刻での保存量$H_0$と時刻$t$での保存量$H_t$との誤差も比較した．
実験を行った設定での初期時刻の保存量$H_0$は，$H_0 =2.82944154167\dots$である．
\paragraph*{陽的Euler法を用いた場合}
最初に，Euler法による計算の数値解に対する誤差を確かめる．
数値解法の刻み幅を$\Delta t = 2^{-7},2^{-13}$とした場合のEuler法による数値解の誤差を比較した．
以下がその結果である．
\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lotkavolterra/lotkavolterra_2^(-7)_euler_error.pdf}
        \caption{Euler法を用いて更新幅を$\Delta t = 2^{-7}$とした場合の異なる数値型(Float64,Q11f52,Q3f60)を用いて数値計算をしたときの数値解とBigFloat型を用いた精度の高い数値解との誤差}
        \label{fig:lotkavolterra_2^(-7)_euler_error}
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lotkavolterra/lotkavolterra_2^(-13)_euler_error.pdf}
        \caption{Euler法を用いて更新幅を$\Delta t =  2^{-13}$とした場合の異なる数値型(Float64,Q11f52,Q3f60)を用いて数値計算をしたときの数値解とBigFloat型を用いた精度の高い数値解との誤差}
        \label{fig:lotkavolterra_2^(-13)_euler_error}
    \end{minipage}
\end{figure}
%考察
\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lotkavolterra/lotkavolterra_2^(-7)_euler_h_error.pdf}
        \caption{Euler法を用いて更新幅を$\Delta t = 2^{-7}$とした場合の異なる数値型(Float64,Q11f52,Q3f60)を用いて数値計算をしたときの数値解により求めた保存量と初期時刻でのとの誤差}
        \label{fig:lotkavolterra_2^(-7)_euler_h_error}
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lotkavolterra/lotkavolterra_2^(-13)_euler_h_error.pdf}
        \caption{Euler法を用いて更新幅を$\Delta t =  2^{-13}$とした場合の異なる数値型(Float64,Q11f52,Q3f60)を用いて数値計算をしたときの数値解により求めた保存量と初期時刻での保存量との誤差}
        \label{fig:lotkavolterra_2^(-13)_euler_h_error}
    \end{minipage}
\end{figure}

\paragraph*{4段4次陽的Runge-Kutta法を用いた場合}
最初に，4段4次陽的Runge-Kutta法による計算の数値解に対する誤差を確かめる．
数値解法の刻み幅を$\Delta t = 2^{-7},2^{-13}$とした場合の4段4次陽的Runge-Kutta法による数値解の誤差を比較した．
以下がその結果である．
\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lotkavolterra/lotkavolterra_2^(-7)_rk4_error.pdf}
        \caption{4段4次陽的Runge-Kutta法を用いて更新幅を$\Delta t = 2^{-7}$とした場合の異なる数値型(Float64,Q11f52,Q3f60)を用いて数値計算をしたときの数値解とBigFloat型を用いた精度の高い数値解との誤差}
        \label{fig:lotkavolterra_2^(-7)_rk4_error}
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lotkavolterra/lotkavolterra_2^(-13)_rk4_error.pdf}
        \caption{4段4次陽的Runge-Kutta法を用いて更新幅を$\Delta t =  2^{-13}$とした場合の異なる数値型(Float64,Q11f52,Q3f60)を用いて数値計算をしたときの数値解とBigFloat型を用いた精度の高い数値解との誤差}
        \label{fig:lotkavolterra_2^(-13)_rk4_error}
    \end{minipage}
\end{figure}
%考察
\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lotkavolterra/lotkavolterra_2^(-7)_rk4_h_error.pdf}
        \caption{4段4次陽的Runge-Kutta法を用いて更新幅を$\Delta t = 2^{-7}$とした場合の異なる数値型(Float64,Q11f52,Q3f60)を用いて数値計算をしたときの数値解により求めた保存量と初期時刻での保存量との誤差}
        \label{fig:lotkavolterra_2^(-7)_rk4_h_error}
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lotkavolterra/lotkavolterra_2^(-13)_rk4_h_error.pdf}
        \caption{4段4次陽的Runge-Kutta法を用いて更新幅を$\Delta t =  2^{-13}$とした場合の異なる数値型(Float64,Q11f52,Q3f60)を用いて数値計算をしたときの数値解により求めた保存量と初期時刻での保存量との誤差}
        \label{fig:lotkavolterra_2^(-13)_rk4_h_error}
    \end{minipage}
\end{figure}

\paragraph*{St\"ormer-Verlet法を用いた場合}
次に，St\"ormer-Verlet法を用いた場合での数値解の誤差を確認した．
St\"ormer-Verlet法は，保存量を保つ性質のある解法である．

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lotkavolterra/lotkavolterra_2^(-7)_BigFloat_sv_h.pdf}
        \caption{St\"ormer-Verlet法を用いて更新幅を$\Delta t = 2^{-7}$とした場合のBigFloat型を用いたときの保存量}        
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lotkavolterra/lotkavolterra_2^(-13)_BigFloat_sv_h.pdf}
        \caption{St\"ormer-Verlet法を用いて更新幅を$\Delta t =  2^{-13}$とした場合のBigFloat型を用いたときの保存量}
    \end{minipage}
\end{figure}
以下がその結果である．

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lotkavolterra/lotkavolterra_2^(-7)_sv_error.pdf}
        \caption{St\"ormer-Verlet法を用いて更新幅を$\Delta t = 2^{-7}$とした場合の異なる数値型(Float64,Q11f52,Q3f60)を用いて数値計算をしたときの数値解とBigFloat型を用いた精度の高い数値解との誤差}
        \label{fig:lotkavolterra_2^(-7)_sv_error}
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lotkavolterra/lotkavolterra_2^(-13)_sv_error.pdf}
        \caption{St\"ormer-Verlet法を用いて更新幅を$\Delta t =  2^{-13}$とした場合の異なる数値型(Float64,Q11f52,Q3f60)を用いて数値計算をしたときの数値解とBigFloat型を用いた精度の高い数値解との誤差}
        \label{fig:lotkavolterra_2^(-13)_sv_error}
    \end{minipage}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lotkavolterra/lotkavolterra_2^(-7)_sv_h_error.pdf}
        \caption{St\"ormer-Verlet法を用いて更新幅を$\Delta t = 2^{-7}$とした場合の異なる数値型(Float64,Q11f52,Q3f60)を用いて数値計算をしたときの数値解により求めた保存量と初期時刻での保存量との誤差}
        \label{fig:lotkavolterra_2^(-7)_sv_h_error}
    \end{minipage}
    \begin{minipage}[b]{0.49\columnwidth}
        \centering
        \includegraphics[width=0.9\columnwidth]{fig_lotkavolterra/lotkavolterra_2^(-13)_sv_h_error.pdf}
        \caption{St\"ormer-Verlet法を用いて更新幅を$\Delta t =  2^{-13}$とした場合の異なる数値型(Float64,Q11f52,Q3f60)を用いて数値計算をしたときの数値解により求めた保存量と初期時刻での保存量との誤差}
        \label{fig:lotkavolterra_2^(-13)_sv_h_error}
    \end{minipage}
\end{figure}